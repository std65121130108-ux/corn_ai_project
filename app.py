import streamlit as st
import tensorflow as tf
from PIL import Image, ImageOps
import numpy as np
import os

# --- 1. ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö ---
st.set_page_config(
    page_title="Chili Doctor AI",
    page_icon="üå∂Ô∏è",
    layout="centered"
)

# --- 2. üé® CSS ‡∏ï‡∏Å‡πÅ‡∏ï‡πà‡∏á (Gray Box Theme) ---
def local_css():
    st.markdown("""
    <style>
        /* ‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡∏ü‡∏≠‡∏ô‡∏ï‡πå Prompt */
        @import url('https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600;700&display=swap');
        
        /* ‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡∏ü‡∏≠‡∏ô‡∏ï‡πå‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏ô‡πâ‡∏≤ */
        html, body, [class*="css"] {
            font-family: 'Prompt', sans-serif;
        }
        
        /* 1. ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏´‡∏•‡∏±‡∏Å (Background) - ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏µ‡πÄ‡∏Ç‡πâ‡∏°‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏Å‡∏•‡πà‡∏≠‡∏á‡πÄ‡∏ó‡∏≤‡πÄ‡∏î‡πà‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô */
        .stApp, [data-testid="stAppViewContainer"] {
            background-color: #222222 !important; /* ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡πÄ‡∏ß‡πá‡∏ö‡∏™‡∏µ‡∏î‡∏≥‡πÄ‡∏ó‡∏≤ */
            background-image: none !important;
        }

        /* 2. ‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏á "‡∏Å‡∏£‡∏≠‡∏ö/‡∏Å‡∏≤‡∏£‡πå‡∏î" (‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏à‡∏≤‡∏Å Glass ‡πÄ‡∏õ‡πá‡∏ô Gray Box ‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏Ç‡∏≠) */
        [data-testid="stVerticalBlockBorderWrapper"] {
            background-color: #e0e0e0 !important;       /* ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏™‡∏µ‡πÄ‡∏ó‡∏≤ */
            border: 2px solid #333333 !important;       /* ‡∏Ç‡∏≠‡∏ö‡∏™‡∏µ‡πÄ‡∏Ç‡πâ‡∏°‡πÅ‡∏•‡∏∞‡∏´‡∏ô‡∏≤‡∏Ç‡∏∂‡πâ‡∏ô */
            box-shadow: 4px 4px 10px rgba(0,0,0,0.5) !important; /* ‡πÉ‡∏™‡πà‡πÄ‡∏á‡∏≤‡∏ä‡∏±‡∏î‡πÜ */
            border-radius: 10px !important;             /* ‡∏°‡∏∏‡∏°‡∏°‡∏ô */
            
            padding: 40px 30px !important;
            margin-bottom: 20px;
            
            /* Animation ‡∏ï‡∏≠‡∏ô‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏ß‡πá‡∏ö */
            animation: fadeUp 0.8s ease-out;
        }
        
        /* ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏™‡∏µ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏ã‡πâ‡∏≠‡∏ô‡∏ó‡∏±‡∏ö */
        [data-testid="stVerticalBlockBorderWrapper"] > div {
            background-color: transparent !important;
        }
        
        /* ‡∏ã‡πà‡∏≠‡∏ô Header/Footer ‡πÄ‡∏î‡∏¥‡∏° */
        #MainMenu {visibility: hidden;}
        header {visibility: hidden;}
        footer {visibility: hidden;}

        /* 3. ‡∏™‡πà‡∏ß‡∏ô‡∏´‡∏±‡∏ß (Icon & Titles) */
        .card-header-custom {
            text-align: center;
            margin-bottom: 20px;
        }
        
        .app-icon {
            width: 100px;
            height: 100px;
            background-color: #ffffff; /* ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡∏™‡∏µ‡∏Ç‡∏≤‡∏ß */
            border: 2px solid #333;    /* ‡∏Ç‡∏≠‡∏ö‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡∏™‡∏µ‡∏î‡∏≥ */
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 50px;
            margin: 0 auto 20px;
            box-shadow: 2px 2px 5px rgba(0,0,0,0.2);
            cursor: default;
        }
        
        .subtitle {
            color: #d32f2f;
            font-weight: 700;
            font-size: 0.9rem;
            letter-spacing: 1px;
            text-transform: uppercase;
            margin-bottom: 5px;
        }
        
        h1 {
            color: #000000 !important; /* ‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏™‡∏µ‡∏î‡∏≥‡∏™‡∏ô‡∏¥‡∏ó */
            font-weight: 800 !important;
            font-size: 2rem !important;
            margin: 0 !important;
            padding: 0 !important;
            text-align: center;
            text-transform: uppercase;
        }
        
        /* 4. ‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢ (Description) */
        .description {
            color: #333333; /* ‡∏ï‡∏±‡∏ß‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏™‡∏µ‡πÄ‡∏Ç‡πâ‡∏° */
            font-weight: 500;
            font-size: 0.95rem;
            line-height: 1.6;
            text-align: center;
            margin-bottom: 30px;
        }

        /* 5. ‡∏õ‡∏∏‡πà‡∏°‡∏Å‡∏î (Button) - ‡∏õ‡∏£‡∏±‡∏ö‡∏™‡πÑ‡∏ï‡∏•‡πå‡πÉ‡∏´‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡∏Å‡∏±‡∏ö‡∏ò‡∏µ‡∏° */
        div.stButton > button {
            background-color: #333333 !important; /* ‡∏õ‡∏∏‡πà‡∏°‡∏™‡∏µ‡∏î‡∏≥ */
            background-image: none !important;
            color: white !important;
            border: 2px solid #000 !important;
            border-radius: 50px !important;
            padding: 12px 40px !important;
            font-size: 1.1rem !important;
            font-weight: 600 !important;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3) !important;
            width: 100% !important;
            transition: all 0.2s ease !important;
        }
        div.stButton > button:hover {
            transform: scale(1.02) !important;
            background-color: #555555 !important; /* ‡∏ä‡∏µ‡πâ‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏µ */
            color: white !important;
        }
        
        /* 6. File Uploader */
        [data-testid="stFileUploaderDropzone"] {
            background-color: #ffffff !important; /* ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏µ‡∏Ç‡∏≤‡∏ß */
            border: 2px dashed #333333 !important; /* ‡πÄ‡∏™‡πâ‡∏ô‡∏õ‡∏∞‡∏™‡∏µ‡∏î‡∏≥ */
            border-radius: 15px !important;
            color: #333 !important;
        }
        [data-testid="stFileUploaderDropzone"] div {
            color: #333 !important;
        }
        
        /* 7. Footer */
        .footer-credit {
            font-size: 0.8rem;
            color: #555;
            margin-top: 30px;
            padding-top: 15px;
            text-align: center;
            border-top: 2px solid #ccc;
            font-weight: 500;
        }
        .badge-custom {
            background-color: #333;
            color: #fff;
            padding: 0.35em 0.65em;
            font-size: 0.75em;
            font-weight: 700;
            border-radius: 0.25rem;
            display: inline-block;
            margin-top: 10px;
        }

        /* Animation Keyframes */
        @keyframes fadeUp {
            from { opacity: 0; transform: translateY(40px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
    """, unsafe_allow_html=True)
local_css()

# --- 3. ‡πÇ‡∏´‡∏•‡∏î‡πÇ‡∏°‡πÄ‡∏î‡∏• ---
@st.cache_resource
def load_model():
    filename = 'efficientnetb4_model.h5'
    if not os.path.exists(filename):
        file_id = '1tURhAR8mXLAgnuU3EULswpcFGxnalWAV'
        url = f'https://drive.google.com/uc?id={file_id}'
        with st.status("‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÇ‡∏°‡πÄ‡∏î‡∏•...", expanded=True) as status:
            try:
                import gdown
                gdown.download(url, filename, quiet=False)
                if os.path.exists(filename):
                    status.update(label="‚úÖ ‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô!", state="complete", expanded=False)
                else:
                    return None
            except:
                return None
    try:
        return tf.keras.models.load_model(filename)
    except:
        return None

# ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢
def import_and_predict(image_data, model):
    size = (300, 300)
    image = ImageOps.fit(image_data, size, Image.Resampling.LANCZOS)
    img_array = np.asarray(image).astype(np.float32)
    data = np.ndarray(shape=(1, 300, 300, 3), dtype=np.float32)
    data[0] = img_array
    return model.predict(data)

# --- 4. ‡∏™‡πà‡∏ß‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏• (UI) ---

model = load_model()

# --- ‚≠ê ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏£‡∏≠‡∏ö‡∏™‡πÑ‡∏ï‡∏•‡πå Gray Box (‡∏ï‡∏≤‡∏°‡∏Ñ‡∏≥‡∏Ç‡∏≠) ‚≠ê ---
with st.container(border=True):
    
    # 1. ‡∏™‡πà‡∏ß‡∏ô‡∏´‡∏±‡∏ß (Icon + Titles)
    st.markdown("""
        <div class="card-header-custom">
            <div class="app-icon">üå∂Ô∏è</div>
            <div class="subtitle">AI Expert System</div>
            <h1>Chili Doctor AI</h1>
        </div>
        
        <p class="description">
            ‡∏£‡∏∞‡∏ö‡∏ö‡∏ú‡∏π‡πâ‡πÄ‡∏ä‡∏µ‡πà‡∏¢‡∏ß‡∏ä‡∏≤‡∏ç‡∏õ‡∏±‡∏ç‡∏ç‡∏≤‡∏õ‡∏£‡∏∞‡∏î‡∏¥‡∏©‡∏ê‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ß‡∏¥‡∏ô‡∏¥‡∏à‡∏â‡∏±‡∏¢‡πÇ‡∏£‡∏Ñ‡∏û‡∏£‡∏¥‡∏Å‡∏à‡∏≤‡∏Å‡πÉ‡∏ö <br>
            ‡∏î‡πâ‡∏ß‡∏¢‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ <strong>Deep Learning (EfficientNetB4)</strong> <br>
            ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥‡∏™‡∏π‡∏á ‡∏£‡∏ß‡∏î‡πÄ‡∏£‡πá‡∏ß ‡πÅ‡∏•‡∏∞‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏á‡πà‡∏≤‡∏¢
        </p>
    """, unsafe_allow_html=True)

    # 2. ‡∏™‡πà‡∏ß‡∏ô‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î
    file = st.file_uploader("", type=["jpg", "png", "jpeg"])
    
    if file is None:
        st.markdown("""
            <div style="text-align: center; margin-top: 10px;">
                <small style="color: #555; font-weight: bold;">*‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡∏¥‡∏î‡∏ú‡πà‡∏≤‡∏ô Google Chrome ‡∏´‡∏£‡∏∑‡∏≠ Safari</small>
            </div>
        """, unsafe_allow_html=True)

    # 3. ‡∏™‡πà‡∏ß‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•
    if file is not None:
        image = Image.open(file)
        
        st.markdown("<br>", unsafe_allow_html=True)
        # ‡∏à‡∏±‡∏î‡∏£‡∏π‡∏õ‡πÉ‡∏´‡πâ‡∏≠‡∏¢‡∏π‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏•‡∏≤‡∏á‡∏™‡∏ß‡∏¢‡πÜ
        col1, col2, col3 = st.columns([1, 2, 1])
        with col2:
            st.image(image, use_container_width=True)
            
        if st.button("üöÄ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÇ‡∏£‡∏Ñ"):
            if model is None:
                st.error("‚ùå ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡πÇ‡∏°‡πÄ‡∏î‡∏•‡πÑ‡∏î‡πâ")
            else:
                with st.spinner('AI ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•...'):
                    predictions = import_and_predict(image, model)
                    class_names = ['healthy', 'leaf curl', 'leaf spot', 'whitefly', 'yellow']
                    class_index = np.argmax(predictions)
                    result_class = class_names[class_index]
                    confidence = np.max(predictions) * 100

                # ‡πÄ‡∏™‡πâ‡∏ô‡∏Ñ‡∏±‡πà‡∏ô‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πå‡∏î
                st.markdown("<hr style='margin: 30px 0; border-top: 2px solid #bbb;'>", unsafe_allow_html=True)
                
                st.markdown(f"""
                    <div style="text-align: center;">
                        <h3 style="color: #333; margin-bottom: 5px;">‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå</h3>
                        <h1 style="color: #d32f2f; font-size: 2.5rem; margin: 0; text-shadow: 1px 1px 0px white;">{result_class}</h1>
                        <p style="color: #333; font-weight: bold;">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏±‡πà‡∏ô‡πÉ‡∏à: <b>{confidence:.2f}%</b></p>
                    </div>
                """, unsafe_allow_html=True)

                # --- ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ Icon ‡πÅ‡∏•‡∏∞‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏ï‡∏≤‡∏°‡πÇ‡∏£‡∏Ñ ---
                treatment_text = ""
                bg_color = "#fff3cd"
                text_color = "#856404"
                border_color = "#ffecb5"
                icon = "‚ö†Ô∏è" # ‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô
                
                if result_class == 'healthy':
                    treatment_text = "‡∏ï‡πâ‡∏ô‡∏û‡∏£‡∏¥‡∏Å‡πÅ‡∏Ç‡πá‡∏á‡πÅ‡∏£‡∏á‡∏î‡∏µ! ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏£‡πà‡∏≠‡∏á‡∏£‡∏≠‡∏¢‡πÇ‡∏£‡∏Ñ ‡∏´‡∏°‡∏±‡πà‡∏ô‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏î‡∏ô‡πâ‡∏≥‡πÅ‡∏•‡∏∞‡πÉ‡∏™‡πà‡∏õ‡∏∏‡πã‡∏¢‡∏ï‡∏≤‡∏°‡∏õ‡∏Å‡∏ï‡∏¥"
                    bg_color = "#d4edda"
                    text_color = "#155724"
                    border_color = "#c3e6cb"
                    icon = "üåø"
                elif result_class == 'leaf curl':
                    treatment_text = "‡πÇ‡∏£‡∏Ñ‡πÉ‡∏ö‡∏´‡∏á‡∏¥‡∏Å‡∏°‡∏±‡∏Å‡πÄ‡∏Å‡∏¥‡∏î‡∏à‡∏≤‡∏Å‡πÅ‡∏°‡∏•‡∏á‡∏´‡∏ß‡∏µ‡πà‡∏Ç‡∏≤‡∏ß ‡πÉ‡∏´‡πâ‡∏Å‡∏≥‡∏à‡∏±‡∏î‡∏ß‡∏±‡∏ä‡∏û‡∏∑‡∏ä‡πÅ‡∏•‡∏∞‡πÉ‡∏ä‡πâ‡∏™‡∏≤‡∏£‡∏™‡∏Å‡∏±‡∏î‡∏™‡∏∞‡πÄ‡∏î‡∏≤ ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏ä‡∏∑‡πâ‡∏≠‡∏£‡∏≤‡πÄ‡∏°‡∏ï‡∏≤‡πÑ‡∏£‡πÄ‡∏ã‡∏µ‡∏¢‡∏°‡∏â‡∏µ‡∏î‡∏û‡πà‡∏ô"
                    icon = "üåÄ"
                elif result_class == 'leaf spot':
                    treatment_text = "‡πÇ‡∏£‡∏Ñ‡πÉ‡∏ö‡∏à‡∏∏‡∏î‡∏ï‡∏≤‡∏Å‡∏ö ‡πÄ‡∏Å‡∏¥‡∏î‡∏à‡∏≤‡∏Å‡πÄ‡∏ä‡∏∑‡πâ‡∏≠‡∏£‡∏≤ ‡πÉ‡∏´‡πâ‡∏ï‡∏±‡∏î‡πÅ‡∏ï‡πà‡∏á‡πÉ‡∏ö‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡πÇ‡∏£‡∏Ñ‡πÄ‡∏ú‡∏≤‡∏ó‡∏≥‡∏•‡∏≤‡∏¢ ‡πÅ‡∏•‡∏∞‡∏â‡∏µ‡∏î‡∏û‡πà‡∏ô‡∏™‡∏≤‡∏£‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡πÄ‡∏ä‡∏∑‡πâ‡∏≠‡∏£‡∏≤"
                    icon = "üçÇ"
                elif result_class == 'whitefly':
                      treatment_text = "‡∏û‡∏ö‡πÅ‡∏°‡∏•‡∏á‡∏´‡∏ß‡∏µ‡πà‡∏Ç‡∏≤‡∏ß ‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ‡∏Å‡∏±‡∏ö‡∏î‡∏±‡∏Å‡∏Å‡∏≤‡∏ß‡πÄ‡∏´‡∏ô‡∏µ‡∏¢‡∏ß‡∏™‡∏µ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á ‡∏´‡∏£‡∏∑‡∏≠‡∏â‡∏µ‡∏î‡∏û‡πà‡∏ô‡∏ô‡πâ‡∏≥‡∏´‡∏°‡∏±‡∏Å‡∏™‡∏°‡∏∏‡∏ô‡πÑ‡∏û‡∏£"
                      icon = "ü™∞"
                elif result_class == 'yellow':
                      treatment_text = "‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡πÉ‡∏ö‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á ‡∏≠‡∏≤‡∏à‡πÄ‡∏Å‡∏¥‡∏î‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏î‡∏™‡∏≤‡∏£‡∏≠‡∏≤‡∏´‡∏≤‡∏£ ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏ß‡∏£‡∏±‡∏™ ‡∏Ñ‡∏ß‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏î‡∏¥‡∏ô‡πÅ‡∏•‡∏∞‡πÉ‡∏™‡πà‡∏õ‡∏∏‡πã‡∏¢‡∏ö‡∏≥‡∏£‡∏∏‡∏á"
                      icon = "üü°"
                
                # ‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå (‡πÉ‡∏´‡πâ‡∏Ç‡∏≠‡∏ö‡πÄ‡∏Ç‡πâ‡∏°‡∏Ç‡∏∂‡πâ‡∏ô‡∏ï‡∏≤‡∏°‡∏ò‡∏µ‡∏°)
                st.markdown(f"""
                    <div style="background-color: {bg_color}; color: {text_color}; border: 2px solid {text_color}; padding: 20px; border-radius: 12px; margin-top: 15px; font-size: 0.95rem; box-shadow: 2px 2px 5px rgba(0,0,0,0.1);">
                        <div style="display: flex; align-items: start;">
                            <div style="font-size: 1.8rem; margin-right: 15px;">{icon}</div>
                            <div>
                                <strong style="display: block; margin-bottom: 5px;">‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥:</strong>
                                {treatment_text}
                            </div>
                        </div>
                    </div>
                """, unsafe_allow_html=True)

    # 4. Footer (Credit)
    st.markdown("""
        <div class="footer-credit">
            ‡πÇ‡∏Ñ‡∏£‡∏á‡∏á‡∏≤‡∏ô‡∏ß‡∏¥‡∏à‡∏±‡∏¢‡∏ó‡∏≤‡∏á‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå <br>
            <strong>‡∏°‡∏´‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢‡∏£‡∏≤‡∏ä‡∏†‡∏±‡∏è‡∏≠‡∏∏‡∏ö‡∏•‡∏£‡∏≤‡∏ä‡∏ò‡∏≤‡∏ô‡∏µ</strong> <br>
            <span class="badge-custom">v.1.0 (Final Release)</span> <br>
            <div style="margin-top: 10px; font-size: 0.75rem; color: #555;">
                ‡∏û‡∏±‡∏í‡∏ô‡∏≤‡πÇ‡∏î‡∏¢: ‡πÅ‡∏°‡∏ß‡∏™‡∏µ‡∏Ç‡∏≤‡∏ß‡πÄ‡∏ó‡∏≤ ‡πÅ‡∏•‡∏∞‡∏ú‡∏≠‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô
            </div>
        </div>
    """, unsafe_allow_html=True)